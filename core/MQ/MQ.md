# MQ

## 1. 引言

### 1.1 什么是MQ

​	`MQ`（Message Quene）：翻译为 `消息队列`，通过典型的 `生产者` 和 `消费者`模型，生产者不断向消息队列中生产消息。因为消息的生产和消费都是异步的，而且只关心消息的发送和接收，没有业务逻辑的侵入，轻松的实现系统间解耦。别名为 `消息中间件` 通过利用高效可靠的消息机制进行平台无关的数据交流，并基于数据通信来进行分布式系统的集成

### 1.2 不同的MQ

#### ActiveMQ

​	ActiveMQ 是 Apache出品，最流行的，能力强劲的开源消息总线，他是一个完全支持JMS规范的消息中间件，丰富的API，多种集群架构模式让ActiveMQ在业界称为老牌的消息中间件，在中小企业颇受欢迎

#### Kafka

​	Kafka是LinkedIn开源的分布是发布-订阅消息系统，目前归属于Apache顶级项目，Kafka主要特点是基于Pull的模式来处理消息消费，追求高吞吐量，一开始的目的就是用于日志手机和传输，0.8版本开始支持复制，不支持事务，对消息的重复、丢失、错误没有严格要求，适合产生大量数据的互联网服务的数据收集服务

#### RocketMQ

​	RocketMQ是阿里开源的消息中间件，他是纯Java开发，具有高吞吐量、高可用性、适合大规模分布式系统应用的特点。RocketMQ思路起源于Kafka。单并不是Kafka的一个Copy，它对消息的可靠传输及事务做了优化，目前在里集团被广泛应用于交易、充值、流计算、消息推送、日志流式处理、binglog分发等场景

#### RabbitMQ

​	RabbitMQ是使用Erlang语言开发的开源消息队列系统，基于AMQP协议来实现。AMQP的主要特征是面向消息、队列、路由（包括点对点和发布/订阅）、可靠性、安全、AMQP协议更多用在企业系统内对数据一致性、稳定性和可靠性要求很高的场景，对性能和吞吐量的要求还在其次

（RabbitMQ比Kafka更适合IO高吞吐的处理，一般应用在大数据日志处理或对实时性（少量延迟），可靠性（少量丢数据）要求稍低的场景使用，比如ELK日志收集）

#### 横比

|                          | ActiveMQ                            | RabbitMQ                                           | RocketMQ                                                     | Kafka                                                        |
| ------------------------ | ----------------------------------- | -------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 单机吞吐量               | 万级，比RocketMQ、Kafka第一个数量级 | 同  ←                                              | 10万                                                         | 10万，一般在大数据的业务场景使用，如实时数据计算、日志采集等 |
| topic 数量对吞吐量的影响 |                                     |                                                    | topic 可以达到几百/几千的级别，吞吐量会有较小幅度的下降，这是 RocketMQ 的一大优势，在同等机器下，可以支撑大量的 topic | topic 从几十到几百个时候，吞吐量会大幅度下降，在同等机器下，Kafka 尽量保证 topic 数量不要过多，如果要支撑大规模的 topic，需要增加更多的机器资源 |
| 时效性                   | ms                                  | 微妙（延迟最低）                                   | ms                                                           | ms以内                                                       |
| 可用性                   | 高，主从架构实现高可用              | 同 ←                                               | 非常高，分布式架构                                           | 同 ←                                                         |
| 消息可靠性               | 较低概率丢失数据                    | 基本不丢                                           | 经过参数配置，可以做到 0 丢失                                | 同 ←                                                         |
| 功能支持                 | MQ 领域的功能极其完备               | 基于 erlang 开发，并发能力很强，性能极好，延时很低 | MQ 功能较为完善，还是分布式的，扩展性好                      | 功能较为简单，主要支持简单的 MQ 功能                         |

> 参考：https://github.com/doocs/advanced-java/blob/master/docs/high-concurrency/why-mq.md
